<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LuxeModes - Modern Apparel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .nav-link { position: relative; color: #374151; text-decoration: none; transition: color 0.3s; }
        .nav-link::after { content: ''; position: absolute; width: 0; height: 2px; bottom: -4px; left: 50%; background-color: #1a1a1a; transition: all 0.3s; }
        .nav-link:hover { color: #1a1a1a; }
        .nav-link:hover::after { width: 100%; left: 0; }
        .product-card-info { background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(5px); transform: translateY(100%); transition: transform 0.4s ease-in-out; }
        .group:hover .product-card-info { transform: translateY(0); }
        .cart-drawer { transition: transform 0.3s ease-in-out; }
        .cart-open { transform: translateX(0); }
        .cart-closed { transform: translateX(100%); }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <!-- Header & Navigation -->
    <header class="fixed top-0 left-0 right-0 z-50 bg-white/80 backdrop-blur-md shadow-sm">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#" class="text-2xl font-bold tracking-wider">LuxeModes</a>
            <div class="hidden md:flex items-center space-x-8">
                <a href="#home" class="nav-link">Home</a>
                <a href="#shop" class="nav-link">Shop</a>
                <a href="#about" class="nav-link">About</a>
            </div>
            <div class="flex items-center">
                <button id="cart-button" class="relative hover:text-black transition-colors">
                    <i class="fas fa-shopping-bag fa-lg"></i>
                    <span id="cart-count" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center hidden">0</span>
                </button>
                <button id="mobile-menu-button" class="md:hidden ml-4">
                     <i class="fas fa-bars fa-lg"></i>
                </button>
            </div>
        </nav>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-white/90 backdrop-blur-md">
            <a href="#home" class="block text-center py-2 px-4 text-sm hover:bg-gray-200">Home</a>
            <a href="#shop" class="block text-center py-2 px-4 text-sm hover:bg-gray-200">Shop</a>
            <a href="#about" class="block text-center py-2 px-4 text-sm hover:bg-gray-200">About</a>
        </div>
    </header>

    <!-- Main Content -->
    <main>
        <!-- Hero Section -->
        <section id="home" class="h-screen bg-cover bg-center flex items-center" style="background-image: url('https://placehold.co/1920x1080/d1d5db/1a1a1a?text=LuxeModes');">
            <div class="container mx-auto px-6 text-left">
                <div class="bg-white/80 backdrop-blur-sm p-8 rounded-lg max-w-lg">
                    <h1 class="text-5xl font-black mb-4">Timeless Style, Modern Craft.</h1>
                    <p class="text-lg mb-6">Discover curated collections of high-quality apparel designed for the modern wardrobe.</p>
                    <a href="#shop" class="bg-black text-white font-bold py-3 px-8 rounded-lg hover:bg-gray-800 transition-colors">Shop Now</a>
                </div>
            </div>
        </section>

        <!-- Shop Section -->
        <section id="shop" class="py-20">
            <div class="container mx-auto px-6">
                <h2 class="text-3xl font-bold text-center mb-12">Our Collection</h2>
                <div id="product-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Products will be dynamically inserted here by JavaScript -->
                </div>
            </div>
        </section>

        <!-- About Section -->
        <section id="about" class="py-20 bg-white">
            <div class="container mx-auto px-6 flex flex-col md:flex-row items-center gap-12">
                <div class="md:w-1/2">
                    <img src="https://placehold.co/600x400/d1d5db/1a1a1a?text=Our+Story" class="rounded-lg shadow-xl" alt="About LuxeModes">
                </div>
                <div class="md:w-1/2 text-center md:text-left">
                    <h2 class="text-3xl font-bold mb-4">About LuxeModes</h2>
                    <p class="text-gray-700 leading-relaxed">
                        At LuxeModes, we believe in the power of simplicity. Our philosophy is rooted in creating high-quality, versatile clothing that seamlessly integrates into your wardrobe. We are committed to sustainable practices and ethical manufacturing, ensuring every piece you wear not only looks good but feels good, inside and out.
                    </p>
                </div>
            </div>
        </section>
    </main>
    
    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-12">
        <div class="container mx-auto px-6 text-center">
            <p>&copy; 2025 LuxeModes. All Rights Reserved.</p>
            <div class="flex justify-center space-x-6 mt-4">
                <a href="#" class="hover:text-gray-400"><i class="fab fa-instagram"></i></a>
                <a href="#" class="hover:text-gray-400"><i class="fab fa-facebook"></i></a>
                <a href="#" class="hover:text-gray-400"><i class="fab fa-twitter"></i></a>
            </div>
        </div>
    </footer>

    <!-- Shopping Cart Drawer -->
    <div id="cart-drawer" class="cart-drawer fixed top-0 right-0 h-full w-full max-w-md bg-white shadow-2xl z-50 cart-closed">
        <div class="flex flex-col h-full">
            <div class="flex justify-between items-center p-6 border-b">
                <h3 class="text-2xl font-bold">Your Cart</h3>
                <button id="close-cart" class="hover:text-red-500 transition-colors">&times;</button>
            </div>
            <ul id="cart-items" class="flex-grow p-6 overflow-y-auto">
                <!-- Cart items will be dynamically inserted here -->
            </ul>
            <div class="p-6 border-t bg-gray-50">
                <div class="flex justify-between items-center mb-4">
                    <span class="text-lg font-semibold">Subtotal</span>
                    <span id="subtotal" class="text-lg font-bold">$0.00</span>
                </div>
                <button class="w-full bg-black text-white py-3 rounded-lg font-bold hover:bg-gray-800 transition-colors">Checkout</button>
            </div>
        </div>
    </div>

    <!-- Product Modal -->
    <div id="product-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-2xl w-full max-w-4xl flex p-4 relative">
             <button id="close-modal" class="absolute top-4 right-4 text-2xl hover:text-red-500">&times;</button>
             <div id="modal-content" class="flex flex-col md:flex-row gap-8 w-full">
                <!-- Modal content will be dynamically inserted here -->
            </div>
        </div>
    </div>

    <!-- JavaScript Logic -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Application State ---
            const state = {
                products: [], cart: [], isCartOpen: false, isModalOpen: false, selectedProduct: null
            };

            // --- THIS IS THE CONNECTION POINT ---
            // This URL points directly to your backend server.
            const API_BASE_URL = 'https://luxemodes.onrender.com';

            // --- DOM Element Selectors ---
            const productGrid = document.getElementById('product-grid');
            const cartButton = document.getElementById('cart-button');
            const cartDrawer = document.getElementById('cart-drawer');
            const closeCartButton = document.getElementById('close-cart');
            const cartItemsContainer = document.getElementById('cart-items');
            const subtotalElement = document.getElementById('subtotal');
            const cartCountElement = document.getElementById('cart-count');
            const productModal = document.getElementById('product-modal');
            const closeModalButton = document.getElementById('close-modal');
            const modalContent = document.getElementById('modal-content');
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            
            // --- Fallback Data ---
            // This data is used if the backend server cannot be reached.
            const fallbackProducts = [
                { id: 1, name: "Classic Crewneck Tee (Fallback)", price: 35.00, image: "https://placehold.co/600x600/f0f0f0/1a1a1a?text=Tee", category: "Tops", description: "This is fallback data. Start the backend server to see live product information.", colors: ["Black", "White"], sizes: ["S", "M", "L"] },
                { id: 2, name: "Denim Jacket (Fallback)", price: 120.00, image: "https://placehold.co/600x600/e0e0e0/1a1a1a?text=Jacket", category: "Outerwear", description: "This is fallback data. Start the backend server to see live product information.", colors: ["Vintage Blue"], sizes: ["S", "M", "L"] },
                { id: 3, name: "Slim-Fit Chinos (Fallback)", price: 75.00, image: "https://placehold.co/600x600/f5f5f5/1a1a1a?text=Chinos", category: "Bottoms", description: "This is fallback data. Start the backend server to see live product information.", colors: ["Khaki", "Navy"], sizes: ["30x30", "32x32"] },
                { id: 4, name: "Merino Sweater (Fallback)", price: 95.00, image: "https://placehold.co/600x600/fafafa/1a1a1a?text=Sweater", category: "Tops", description: "This is fallback data. Start the backend server to see live product information.", colors: ["Charcoal"], sizes: ["M", "L", "XL"] },
            ];

            // --- Data Fetching ---
            async function fetchProducts() {
                try {
                    // It fetches the specific route you defined in products.js
                    const response = await fetch(`${API_BASE_URL}/api/products`);
                    if (!response.ok) throw new Error(`Network response was not ok: ${response.statusText}`);
                    
                    // If the fetch is successful, remove any old error messages
                    const existingError = document.getElementById('fetch-error');
                    if (existingError) existingError.remove();
                    
                    return await response.json();
                } catch (error) {
                    console.error("--- FETCH FAILED ---");
                    console.error("Could not connect to the backend server. Please ensure the server is running on https://luxemodes.onrender.com.");
                    console.error("Displaying fallback data for demonstration purposes.", error);
                    
                    const shopSection = document.getElementById('shop');
                    // Add a more detailed, instructional error message to the page
                    if (!document.getElementById('fetch-error')) {
                         const errorHTML = `
                            <div id="fetch-error" class="container mx-auto px-6 mb-8 text-left bg-red-100 border-l-4 border-red-500 text-red-800 p-4" role="alert">
                                <p class="font-bold text-lg">Backend Not Connected</p>
                                <p>The website couldn't connect to the deployed backend at <strong>https://luxemodes.onrender.com</strong>. This could be due to:</p>
                                <ul class="list-disc list-inside mt-2 text-sm">
                                    <li>The backend service is temporarily unavailable</li>
                                    <li>Network connectivity issues</li>
                                    <li>The backend URL has changed</li>
                                </ul>
                                <p class="mt-2">The page is currently showing static fallback data. Please <strong>refresh this page</strong> or check back later.</p>
                            </div>`;
                         shopSection.insertAdjacentHTML('afterbegin', errorHTML);
                    }

                    return fallbackProducts;
                }
            }

            // --- Rendering Functions (No changes here) ---
            function renderProducts() {
                productGrid.innerHTML = '';
                state.products.forEach(product => {
                    const productCard = document.createElement('div');
                    productCard.className = 'product-card bg-white rounded-lg overflow-hidden shadow-lg transform hover:scale-105 transition-transform duration-300 cursor-pointer group';
                    productCard.dataset.id = product.id;
                    productCard.innerHTML = `
                        <div class="relative">
                            <img src="${product.image}" alt="${product.name}" class="w-full h-96 object-cover">
                            <div class="absolute bottom-0 left-0 right-0 p-4 product-card-info">
                                <h3 class="font-bold text-lg">${product.name}</h3>
                                <p class="text-gray-600">$${product.price.toFixed(2)}</p>
                            </div>
                        </div>
                    `;
                    productGrid.appendChild(productCard);
                });
            }

            function renderCartItems() {
                cartItemsContainer.innerHTML = '';
                if (state.cart.length === 0) {
                    cartItemsContainer.innerHTML = '<li><p class="text-gray-500">Your cart is empty.</p></li>';
                    subtotalElement.textContent = '$0.00';
                    return;
                }
                let subtotal = 0;
                state.cart.forEach(item => {
                    const li = document.createElement('li');
                    li.className = 'flex items-center justify-between py-4 border-b';
                    li.innerHTML = `
                        <div class="flex items-center">
                            <img src="${item.image}" alt="${item.name}" class="w-16 h-16 object-cover rounded-md mr-4">
                            <div>
                                <h4 class="font-semibold">${item.name}</h4>
                                <p class="text-sm text-gray-500">${item.size} / ${item.color}</p>
                                <p class="text-lg font-bold text-gray-800">$${(item.price * item.quantity).toFixed(2)}</p>
                            </div>
                        </div>
                        <div class="flex items-center gap-3">
                             <input type="number" min="1" value="${item.quantity}" data-id="${item.id}" data-size="${item.size}" data-color="${item.color}" class="quantity-input w-14 text-center border rounded-md p-1">
                             <button data-id="${item.id}" data-size="${item.size}" data-color="${item.color}" class="remove-item-btn text-gray-500 hover:text-red-600 text-2xl font-bold">&times;</button>
                        </div>
                    `;
                    cartItemsContainer.appendChild(li);
                    subtotal += item.price * item.quantity;
                });
                subtotalElement.textContent = `$${subtotal.toFixed(2)}`;
            }
            
            function renderProductModal() {
                const product = state.selectedProduct;
                if (!product) return;
                modalContent.innerHTML = `
                    <div class="md:w-1/2">
                        <img src="${product.image}" alt="${product.name}" class="w-full h-full object-cover rounded-lg">
                    </div>
                    <div class="md:w-1/2 flex flex-col justify-center p-4">
                        <h2 class="text-3xl font-bold mb-2">${product.name}</h2>
                        <p class="text-2xl text-gray-800 mb-4">$${product.price.toFixed(2)}</p>
                        <p class="text-gray-600 mb-6">${product.description}</p>
                        <div class="flex gap-4 mb-6">
                            <div class="flex-1">
                                <label for="size-select" class="block text-sm font-medium text-gray-700">Size</label>
                                <select id="size-select" class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                    ${product.sizes.map(size => `<option>${size}</option>`).join('')}
                                </select>
                            </div>
                            <div class="flex-1">
                                <label for="color-select" class="block text-sm font-medium text-gray-700">Color</label>
                                <select id="color-select" class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                     ${product.colors.map(color => `<option>${color}</option>`).join('')}
                                </select>
                            </div>
                        </div>
                        <button id="add-to-cart-btn" class="w-full bg-black text-white py-3 rounded-lg font-bold hover:bg-gray-800 transition-colors">Add to Cart</button>
                    </div>
                `;
            }

            // --- State Management & Logic (No changes here) ---
            const updateCart = () => {
                renderCartItems();
                const totalItems = state.cart.reduce((sum, item) => sum + item.quantity, 0);
                cartCountElement.textContent = totalItems;
                cartCountElement.classList.toggle('hidden', totalItems === 0);
                localStorage.setItem('luxeModesCart', JSON.stringify(state.cart));
            };

            const toggleCart = () => {
                state.isCartOpen = !state.isCartOpen;
                cartDrawer.classList.toggle('cart-open', state.isCartOpen);
                cartDrawer.classList.toggle('cart-closed', !state.isCartOpen);
            };

            const toggleModal = () => {
                state.isModalOpen = !state.isModalOpen;
                productModal.classList.toggle('hidden', !state.isModalOpen);
                productModal.classList.toggle('flex', state.isModalOpen);
            };

            const openProductModal = (product) => {
                state.selectedProduct = product;
                renderProductModal();
                toggleModal();
            };
            
            const addToCart = (productId, size, color) => {
                const product = state.products.find(p => p.id === productId);
                const existingItem = state.cart.find(item => item.id === productId && item.size === size && item.color === color);

                if (existingItem) {
                    existingItem.quantity++;
                } else {
                    state.cart.push({ ...product, quantity: 1, size, color });
                }
                updateCart();
            };

            const removeFromCart = (productId, size, color) => {
                state.cart = state.cart.filter(item => !(item.id === productId && item.size === size && item.color === color));
                updateCart();
            };
            
            const updateItemQuantity = (productId, size, color, newQuantity) => {
                const item = state.cart.find(i => i.id === productId && i.size === size && i.color === color);
                if (item) {
                    item.quantity = newQuantity > 0 ? newQuantity : 1;
                }
                updateCart();
            };

            // --- Initialization ---
            async function initializeApp() {
                const savedCart = localStorage.getItem('luxeModesCart');
                if (savedCart) state.cart = JSON.parse(savedCart);
                
                state.products = await fetchProducts();
                renderProducts();
                updateCart();

                // Setup Event Listeners
                cartButton.addEventListener('click', toggleCart);
                closeCartButton.addEventListener('click', toggleCart);
                closeModalButton.addEventListener('click', toggleModal);
                mobileMenuButton.addEventListener('click', () => mobileMenu.classList.toggle('hidden'));
                
                productGrid.addEventListener('click', e => {
                    const card = e.target.closest('.product-card');
                    if (card) {
                        const product = state.products.find(p => p.id === parseInt(card.dataset.id));
                        if (product) openProductModal(product);
                    }
                });

                modalContent.addEventListener('click', e => {
                    if (e.target.id === 'add-to-cart-btn') {
                        const { id } = state.selectedProduct;
                        const size = document.getElementById('size-select').value;
                        const color = document.getElementById('color-select').value;
                        addToCart(id, size, color);
                        toggleModal();
                    }
                });

                cartItemsContainer.addEventListener('click', e => {
                    if (e.target.classList.contains('remove-item-btn')) {
                        const { id, size, color } = e.target.dataset;
                        removeFromCart(parseInt(id), size, color);
                    }
                });

                cartItemsContainer.addEventListener('change', e => {
                     if (e.target.classList.contains('quantity-input')) {
                        const { id, size, color } = e.target.dataset;
                        const newQuantity = parseInt(e.target.value);
                        updateItemQuantity(parseInt(id), size, color, newQuantity);
                    }
                });
            }

            initializeApp();
        });
    </script>
</body>
</html>

